# Лабораторная №12 (`WW_vector`)

## Содержание
1. [Содержание](#содержание)
1. [Задание](#задание)
1. [Требования к корректности решения](#требования-к-корректности-решения)
    1. [Стандартные требования](#стандартные-требования)
    1. [Детали реализации `my_vector`](#детали-реализации-my_vector)
    1. [Класс `Product`](#класс-product)
    1. [Консольное приложение](#консольное-приложение)
    1. [Структура репозитория](#структура-репозитория)
1. [Сроки сдачи](#сроки-сдачи)
1. [Система оценки](#система-оценки)

## Задание
Реализовать шаблонный класс `my_vector` со строгими гарантиями исключений.
Можно считать, что для шаблонного типового параметра `T` выполняются следующие требования:

* [CopyConstructible](https://en.cppreference.com/w/cpp/named_req/CopyConstructible).
* [Destructible](https://en.cppreference.com/w/cpp/named_req/Destructible).
* Конструктор перемещения и оператор перемещающего присваивания `T` не бросают исключений.
* Все операции над `T` предоставляют базовую гарантию исключений.

Обратите внимание, что `T` может быть не [DefaultConstructible](https://en.cppreference.com/w/cpp/named_req/DefaultConstructible),
из-за чего нельзя писать `new T[]` в общем случае.

Также требуется:

* Перегрузить `operator<<` для вывода в `ostream` всех элементов `my_vector`.
* Реализовать класс `Product`, демонстрирующий минимальные требования к элементу `my_vector`,
  а также перегружающий `operator<<` для вывода.
* Реализовать шаблонные автоматические тесты `my_vector` и запустить их для `int` и `Product`.

## Требования к корректности решения
### Стандартные требования
Смотри стандартные требования из предыдущих заданий (они теперь доступны [в общей папке](../tasks-common)), название папки и файла — `lab_12`.

Новое требование: всё, кроме `main`, должно лежать в каком-нибудь пространстве имён; обязательно использовать анонимные пространства имён, где разумно.

### Детали реализации `my_vector`
Интерфейс класса определен в `my_vector.h`.
В нём необходимо расставить `&`, `&&`, `const`, `explicit`, `noexcept` (можно без `noexcept(...)`) там, где нужно.
Также может потребоваться разделить один метод на несколько перегрузок.

Реализация всех методов и функций должна располагаться в `my_vector_impl.h`.

Все операции:

* Работают по аналогии с `std::vector`, если в задании не сказано иное
* Предоставляют хотя бы строгую гарантию исключений, в том числе по отношению к `capacity()` и адресам элементов `my_vector`.
* По возможности перемещают элементы, если это можно сделать без нарушений гарантий исключений.
* Выполняют как можно меньше операций с элементами:
  * Не создают лишние элементы.
  * Не создают копии элементов, когда можно обойтись перемещением (без нарушения гарантий).
  * Не делают явно лишних перемещений (например, несколько перемещений между временными объектами).

Следующие операции над `my_vector` разрешаются всегда:

* Конструктор по умолчанию.
* Конструктор копирования.
* Конструктор перемещения.
* Оператор копирующего присваивания.
* Оператор перемещающего присваивания.
* Деструктор.
* `size`.
* `capacity`.
* `empty`.
* `reserve`.
* `operator[]`.
* `push_back`.
* `pop_back`.
* `clear`.

Если тип `T` является [DefaultConstructible](https://en.cppreference.com/w/cpp/named_req/DefaultConstructible),
то также разрешаются следующие операции (в противном случае их использование влечёт ошибку компиляции
в момент инстанцирования соответствующего метода):

* Конструктор от `size_t n` создаёт `my_vector` из `n` элементов, проинициализированных
  конструктором `T` по умолчанию.
* `resize`.

При этом:

* `push_back` увеличивает размер масива в два раза, когда место закончилось.
* Методы и конструкторы, которые увеличивают `capacity`,
  делают его равным минимальной достаточной степени двойки.

Формат `operator<<` для `my_vector`: `<vec[0]> vec[1]> ... <vec[size-1]>` (все элементы `my_vector` через `operator<<`,
разделены ровно одним пробелом, завершающего перевода строки нет).

### Класс `Product`
Интерфейс класса `Product` задан в `main.cpp`, его необходимо доработать,
чтобы он соответствовал *минимальным* требованиям `my_vector`.
При этом запрещается использовать стандартные контейнеры из `STL`,
в том числе `unique_ptr`.

Формат `operator<<` для `Product`: `<name> <quantity> <price>` (поля разделены ровно одним пробелом,
завершающего перевода строки нет).

### Консольное приложение
В `main.cpp` должна быть реализована шаблонная функция `test_my_vector`,
которая автоматически тестирует (см. стандартные требования) все методы класса `my_vector` для заданного типа.
Эта функция вызывается в `main` для `int` и нового типа `Product`.

Также должна быть реализована шаблонная функция `test_my_vector_default_constructible`,
которая тестирует методы класса `my_vector`, включающиеся только для `DefaultConstructible` типов.
Она вызывается в `main` для `int`.

### Структура репозитория
```
<корень-личного-репозитория>
|--lab_12
   |--include
   |  |-- my_vector.h
   |  |-- my_vector_impl.h
   |--src
   |  |-- main.cpp
   |--Makefile
```

Папку `obj`, объектные и исполняемые файлы класть в репозиторий не разрешается.

## Сроки сдачи
Задание выдано 20.02.2020 (четверг).
Крайний срок сдачи — **29.02.2020 (суббота) 22:59 по Москве**.

Также на усмотрение преподавателя могут назначаться дополнительные попытки сдачи и дополнительные сроки
проверки.
Например, преподаватель может оперативно проверить решения, отправленные за несколько дней до дедлайна,
и гораздо медленнее — отправленные перед дедлайном.
Уточняйте у своего преподавателя.

## Система оценки
* Задание оценивается в 10 баллов: 7 за корректность и 3 за стиль.
* Точные критерии оценки каждой из частей остаются на усмотрение преподавателя.
